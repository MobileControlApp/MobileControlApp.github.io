(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{N8wb:function(e,t,n){"use strict";n.r(t),n.d(t,"PlantitWebLanguageDropDown",function(){return o}),n.d(t,"PlantitWebRoleSelection",function(){return s}),n.d(t,"PlantitWebSideMenu",function(){return l}),n.d(t,"PlantitWebSideMenuAccount",function(){return c}),n.d(t,"PlantitWebSideMenuSettings",function(){return u});var r=n("09di"),i=n("KcNB"),o=function(){function e(){this.currentLanguage="",this.expanded=!1,this.frame=document.querySelector("plantit-web-frame")}return e.prototype.tokenArrived=function(){return r.a(this,void 0,void 0,function(){var e;return r.c(this,function(t){switch(t.label){case 0:return this.userLanguageService?[3,2]:(e=this,[4,this.frame.getUserLanguageService()]);case 1:e.userLanguageService=t.sent(),t.label=2;case 2:return this.getLanguages(),[2]}})})},e.prototype.componentDidLoad=function(){return r.a(this,void 0,void 0,function(){var e;return r.c(this,function(t){switch(t.label){case 0:return e=this,[4,this.frame.getUserLanguageService()];case 1:return e.userLanguageService=t.sent(),this.getLanguages(),[2]}})})},e.prototype.toggleList=function(){this.expanded?this.collapseList():this.expandList()},e.prototype.expandList=function(){this.expanded||(this.setDisplayListAndBackdrop("block"),this.expanded=!0)},e.prototype.collapseList=function(){this.setDisplayListAndBackdrop("none"),this.expanded=!1},e.prototype.prepareList=function(e){var t=this;e.forEach(function(e){t.appendItemOnList(e)})},e.prototype.setDisplayListAndBackdrop=function(e){var t=this.languageDropDown.shadowRoot.querySelector(".dropdownList");this.languageDropDown.shadowRoot.querySelector("div .backdrop").style.display=e,t.style.display=e},e.prototype.appendItemOnList=function(e){var t=this.languageDropDown.shadowRoot.querySelector(".dropdownList"),n=document.createElement("li");n.innerText=e,t.appendChild(n)},e.prototype.getLanguages=function(){this.getAllBaseLanguages(),this.getCurrentLanguage()},e.prototype.getCurrentLanguage=function(){var e=this;this.userLanguageService.getCurrentLanguage().then(function(t){e.currentLanguage=t.abbreviation}).catch(function(e){return console.error(e)})},e.prototype.getAllBaseLanguages=function(){var e=this;this.userLanguageService.getAllBaseLanguages().then(function(t){e.prepareList(e.userLanguageService.getLanguageAbbreviation(t))}).catch(function(e){return console.error(e)})},e.prototype.setLanguage=function(e){var t=this;this.userLanguageService.setLanguage(e.innerText).then(function(){t.currentLanguage!==e.innerText&&""!==t.currentLanguage&&(t.currentLanguage=e.innerText,t.languageChanged.emit(t.currentLanguage)),t.collapseList()}).catch(function(e){return console.error("Language could not be set by the plantit-web-language-dropd-down."+e)})},e.prototype.render=function(){var e=this;return Object(i.b)("div",null,Object(i.b)("ul",null,Object(i.b)("li",{class:"language",onClick:function(){return e.toggleList()}},Object(i.b)("p",null,this.currentLanguage)),Object(i.b)("li",null,Object(i.b)("ul",{class:"dropdownList",onClick:function(t){return e.setLanguage(t.target)}}))),Object(i.b)("div",{class:"backdrop",onClick:function(){return e.collapseList()}}))},Object.defineProperty(e,"is",{get:function(){return"plantit-web-language-drop-down"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"encapsulation",{get:function(){return"shadow"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"properties",{get:function(){return{accessToken:{type:String,attr:"access-token",watchCallbacks:["tokenArrived"]},currentLanguage:{state:!0},languageDropDown:{elementRef:!0}}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"events",{get:function(){return[{name:"languageChanged",method:"languageChanged",bubbles:!0,cancelable:!0,composed:!0}]},enumerable:!0,configurable:!0}),Object.defineProperty(e,"style",{get:function(){return"*.sc-plantit-web-language-drop-down{color:#073a73;font-family:sans-serif}ul.sc-plantit-web-language-drop-down{list-style:none;z-index:9998;padding:0;margin:0;background:#cecece}ul.dropdownList.sc-plantit-web-language-drop-down{display:none;position:absolute}.language.sc-plantit-web-language-drop-down:hover{background:#e6e6e6;cursor:pointer}div.sc-plantit-web-language-drop-down{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex}li.sc-plantit-web-language-drop-down:hover{background:#e6e6e6;cursor:pointer}p.sc-plantit-web-language-drop-down{display:inline-block;margin:0;padding:0}.backdrop.sc-plantit-web-language-drop-down{color:transparent;display:none;height:100vh;left:0;position:fixed;top:0;width:100vw;z-index:9997}"},enumerable:!0,configurable:!0}),e}(),a=function(){function e(){this.frame=document.querySelector("plantit-web-frame"),this.getServiceUri()}return e.prototype.getCurrentRole=function(e){return r.a(this,void 0,void 0,function(){return r.c(this,function(t){return[2,this.prepareRequest("GET","/current",e)]})})},e.prototype.getAvailableRoles=function(e){return r.a(this,void 0,void 0,function(){return r.c(this,function(t){return[2,this.prepareRequest("GET","/available",e)]})})},e.prototype.setCurrentRole=function(e,t){return r.a(this,void 0,void 0,function(){return r.c(this,function(n){return[2,this.prepareRequest("PUT","/"+e,t)]})})},e.prototype.prepareRequest=function(e,t,n){return r.a(this,void 0,void 0,function(){return r.c(this,function(r){switch(r.label){case 0:return this.url?[3,2]:[4,this.getServiceUri()];case 1:r.sent(),r.label=2;case 2:if(!n)throw new Error("Roleservice has no Accesstoken, cant request without it.");return[2,this.httpRequest(e,this.url+t,n)]}})})},e.prototype.httpRequest=function(e,t,n){return new Promise(function(r,i){var o=[],a=new XMLHttpRequest;a.open(e,t),a.onload=function(){if(a.status>=200&&a.status<300&&4===a.readyState)if("GET"===e){var t=JSON.parse(JSON.parse(a.response));for(var n in t)if(t.hasOwnProperty(n)&&"ClassifiableSerialzedDict"==n){for(var s in t[n])t[n].hasOwnProperty(s)&&o.push(JSON.parse(t[n][s]));r(o)}}else r("OK");else i({status:a.status,statusText:a.statusText})},a.onerror=function(){i({status:a.status,statusText:a.statusText})},n&&a.setRequestHeader("Authorization","Bearer "+n),a.send()})},e.prototype.getServiceUri=function(){var e=this;return new Promise(function(t){e.frame.componentOnReady().then(function(){e.frame.findService("UserMgmt","RoleSelection").then(function(n){e.url=n.uri,t("ok")}).catch(function(e){throw new Error("Roleservice couldnt get his API URL from ServiceDiscoery"+e)})})})},e}(),s=function(){function e(){this.currentRole="currentRole",this.roleService=new a,this.display=""}return e.prototype.watchToken=function(e,t){e!==t&&this.getCurrentRole()},e.prototype.componentDidLoad=function(){this.getCurrentRole()},e.prototype.getCurrentRole=function(){var e=this;this.roleService.getCurrentRole(this.accessToken).then(function(t){e.currentRole=t[0].Name,e.getAllAvailableRoles()}).catch(function(e){console.error("While requesting the Current Role from the Server, the Server returned an error:"+e)})},e.prototype.getAllAvailableRoles=function(){var e=this;this.allAvailableRoles=[],this.clearList(),this.roleService.getAvailableRoles(this.accessToken).then(function(t){e.allAvailableRoles=t,t.forEach(function(t){e.addRolesToList(t)})}).catch(function(e){console.error("While requesting all Available Roles for the User from the Server, the Server returned an error:"+e)})},e.prototype.addRolesToList=function(e){var t=this.roleDropDown.shadowRoot.querySelector(".roleDropdownList");if(e.Name!==this.currentRole){var n=document.createElement("li");n.innerText=e.Name,t.appendChild(n)}},e.prototype.clearList=function(){for(var e=this.roleDropDown.shadowRoot.querySelector(".roleDropdownList");e.firstChild;)e.removeChild(e.firstChild)},e.prototype.setRole=function(e){var t=this;this.allAvailableRoles.forEach(function(n){n.Name===e.innerText&&t.roleService.setCurrentRole(n.Guid,t.accessToken).then(function(){t.toggleListView(),t.roleChanged.emit("Role changed"),t.getCurrentRole()}).catch(function(e){console.error("While Setting the Current Role on the Server, the Server returned an error:"+e)})})},e.prototype.toggleListView=function(){this.display=""===this.display||"none"===this.display?"block":"none";var e=this.roleDropDown.shadowRoot.querySelector(".roleDropdownList");this.roleDropDown.shadowRoot.querySelector("div .roleBackdrop").style.display=this.display,e.style.display=this.display},e.prototype.render=function(){var e=this;return Object(i.b)("div",null,Object(i.b)("ul",null,Object(i.b)("li",{class:"role",onClick:function(){return e.toggleListView()}},Object(i.b)("p",null,this.currentRole)),Object(i.b)("li",null,Object(i.b)("ul",{class:"roleDropdownList",onClick:function(t){return e.setRole(t.target)}}))),Object(i.b)("div",{class:"roleBackdrop",onClick:function(){return e.toggleListView()}}))},Object.defineProperty(e,"is",{get:function(){return"plantit-web-role-selection"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"encapsulation",{get:function(){return"shadow"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"properties",{get:function(){return{accessToken:{type:String,attr:"access-token",watchCallbacks:["watchToken"]},currentRole:{state:!0},roleDropDown:{elementRef:!0}}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"events",{get:function(){return[{name:"roleChanged",method:"roleChanged",bubbles:!0,cancelable:!0,composed:!0}]},enumerable:!0,configurable:!0}),Object.defineProperty(e,"style",{get:function(){return"*.sc-plantit-web-role-selection{color:#073a73;font-family:sans-serif}ul.sc-plantit-web-role-selection{list-style:none;z-index:9998;padding:0;margin:0;background:#cecece}ul.roleDropdownList.sc-plantit-web-role-selection{display:none;position:absolute}.role.sc-plantit-web-role-selection:hover{background:#e6e6e6;cursor:pointer}div.sc-plantit-web-role-selection{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex}li.sc-plantit-web-role-selection:hover{background:#e6e6e6;cursor:pointer}p.sc-plantit-web-role-selection{display:inline-block;margin:0;padding:0}.roleBackdrop.sc-plantit-web-role-selection{color:transparent;display:none;height:100vh;left:0;position:fixed;top:0;width:100vw;z-index:9997}.title.sc-plantit-web-role-selection{display:block}"},enumerable:!0,configurable:!0}),e}(),l=function(){function e(){this.frame=document.querySelector("plantit-web-frame")}return e.prototype.translate=function(){var e=this;this.frame.translate("_settings").then(function(t){return e.settingsTitle=t}),this.frame.translate("_account").then(function(t){return e.accountTitle=t})},e.prototype.open=function(e){this.type=e,this.sideMenu.style.visibility="visible",this.backdrop.style.visibility="visible"},e.prototype.close=function(){this.type="",this.sideMenu.style.visibility="hidden",this.backdrop.style.visibility="hidden"},e.prototype.componentDidLoad=function(){this.sideMenu=this.PlantitWebSideMenu.shadowRoot.querySelector("#sideMenu"),this.backdrop=this.PlantitWebSideMenu.shadowRoot.querySelector("#backdrop"),this.translate()},e.prototype.chooseType=function(e){switch(e){case"account":return Object(i.b)("plantit-web-side-menu-account",{"side-menutitle":this.accountTitle,language:this.language},Object(i.b)("slot",{name:"userContentAccount",slot:"userContent"}));case"settings":return Object(i.b)("plantit-web-side-menu-settings",{"access-token":this.accessToken,"side-menutitle":this.settingsTitle,language:this.language},Object(i.b)("slot",{name:"userContentSettings",slot:"userContent"}));default:return Object(i.b)("div",null)}},e.prototype.render=function(){var e=this;return Object(i.b)("div",null,Object(i.b)("div",{id:"backdrop",onClick:function(){return e.close()}}),Object(i.b)("div",{id:"sideMenu"},Object(i.b)("div",{id:"closeButton",onClick:function(){return e.close()}},"X"),Object(i.b)("slot",{name:"sideMenuContent"}),this.chooseType(this.type)))},Object.defineProperty(e,"is",{get:function(){return"plantit-web-side-menu"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"encapsulation",{get:function(){return"shadow"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"properties",{get:function(){return{accessToken:{type:String,attr:"access-token"},accountTitle:{state:!0},close:{method:!0},language:{type:String,attr:"language",watchCallbacks:["translate"]},open:{method:!0},PlantitWebSideMenu:{elementRef:!0},settingsTitle:{state:!0},type:{state:!0}}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"style",{get:function(){return"#sideMenu.sc-plantit-web-side-menu{background-color:#cecece;-webkit-box-sizing:border-box;box-sizing:border-box;height:calc(100vh - 40px);width:100vw;padding:1em;position:absolute;right:0;top:40px;visibility:hidden;z-index:50}#backdrop.sc-plantit-web-side-menu{background-color:rgba(0,0,0,.2);height:100vh;position:absolute;right:0;top:0;visibility:hidden;width:100vw}#closeButton.sc-plantit-web-side-menu{position:absolute;top:1em;right:1em}@media only screen and (min-width:800px){#sideMenu.sc-plantit-web-side-menu{min-width:300px;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content}#closeButton.sc-plantit-web-side-menu{position:absolute;visibility:hidden}}"},enumerable:!0,configurable:!0}),e}(),c=function(){function e(){}return e.prototype.render=function(){return[Object(i.b)("h1",null,this.sideMenuTitle),Object(i.b)("br",null),Object(i.b)("slot",{name:"userContent"})]},Object.defineProperty(e,"is",{get:function(){return"plantit-web-side-menu-account"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"encapsulation",{get:function(){return"shadow"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"properties",{get:function(){return{language:{type:String,attr:"language"},sideMenuTitle:{type:String,attr:"side-menu-title"}}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"style",{get:function(){return""},enumerable:!0,configurable:!0}),e}(),u=function(){function e(){}return e.prototype.componentDidLoad=function(){this.translate()},e.prototype.translate=function(){return r.a(this,void 0,void 0,function(){var e,t=this;return r.c(this,function(n){switch(n.label){case 0:return[4,(e=document.querySelector("plantit-web-frame")).componentOnReady()];case 1:return n.sent(),e.translate("_language").then(function(e){t.languageTitle=e}),e.translate("_role").then(function(e){t.roleTitle=e}),[2]}})})},e.prototype.render=function(){return[Object(i.b)("h1",null,this.sideMenuTitle),Object(i.b)("label",null,this.languageTitle),Object(i.b)("plantit-web-language-drop-down",{"access-token":this.accessToken}),Object(i.b)("br",null),Object(i.b)("label",null,this.roleTitle),Object(i.b)("plantit-web-role-selection",{"access-token":this.accessToken}),Object(i.b)("slot",{name:"userContent"})]},Object.defineProperty(e,"is",{get:function(){return"plantit-web-side-menu-settings"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"encapsulation",{get:function(){return"shadow"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"properties",{get:function(){return{accessToken:{type:String,attr:"access-token"},language:{type:String,attr:"language",watchCallbacks:["translate"]},languageTitle:{state:!0},PlantitWebSideMenuSettings:{elementRef:!0},roleTitle:{state:!0},sideMenuTitle:{type:String,attr:"side-menu-title"}}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"style",{get:function(){return"plantit-web-role-selection.sc-plantit-web-side-menu-settings{width:100%;margin-left:10px;margin-right:10px}"},enumerable:!0,configurable:!0}),e}()}}]);